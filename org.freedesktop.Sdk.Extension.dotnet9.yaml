app-id: org.freedesktop.Sdk.Extension.dotnet9
branch: '24.08'
runtime: org.freedesktop.Sdk
runtime-version: '24.08'
sdk: org.freedesktop.Sdk
build-extension: true
separate-locales: false
modules:
  - name: dotnet-sdk
    buildsystem: simple
    build-commands:
      - mkdir -p /usr/lib/sdk/dotnet9/{bin,lib}
      - cp -r * /usr/lib/sdk/dotnet9/lib
      - ln -s /usr/lib/sdk/dotnet9/lib/dotnet /usr/lib/sdk/dotnet9/bin/dotnet
    sources:
      - type: archive
        only-arches: [x86_64]
        url: https://dotnetcli.blob.core.windows.net/dotnet/Sdk/9.0.200/dotnet-sdk-9.0.200-linux-x64.tar.gz
        sha256: c07281a0abbd2c3200e70fc94d374baeadfbb43c9c3fe90c6038253555b84335
        x-checker-data:
          type: html
          url: https://dotnetcli.blob.core.windows.net/dotnet/Sdk/9.0/latest.version
          version-pattern: ^([\d\.a-z-]+)$
          url-template: https://dotnetcli.blob.core.windows.net/dotnet/Sdk/$version/dotnet-sdk-$version-linux-x64.tar.gz
      - type: archive
        only-arches: [aarch64]
        url: https://dotnetcli.blob.core.windows.net/dotnet/Sdk/9.0.200/dotnet-sdk-9.0.200-linux-arm64.tar.gz
        sha256: 3266045a9b8a5362dca0e148a263385e9ae94920d6f2f56802ad2d5996988bab
        x-checker-data:
          type: html
          url: https://dotnetcli.blob.core.windows.net/dotnet/Sdk/9.0/latest.version
          version-pattern: ^([\d\.a-z-]+)$
          url-template: https://dotnetcli.blob.core.windows.net/dotnet/Sdk/$version/dotnet-sdk-$version-linux-arm64.tar.gz
  - name: nuget-sources
    buildsystem: simple
    build-commands:
      - mkdir -p /usr/lib/sdk/dotnet9/nuget/packages
      - cp * /usr/lib/sdk/dotnet9/nuget/packages
    sources:
      - type: file
        only-arches: [x86_64]
        url: https://api.nuget.org/v3-flatcontainer/microsoft.aspnetcore.app.runtime.linux-x64/9.0.2/microsoft.aspnetcore.app.runtime.linux-x64.9.0.2.nupkg
        sha512: 4c7e3ec07bb6bef202c81f2de645aa268b2a91d093e2f5d559987bde6f0375a7dad5dec2a9adc432bb8e5fb741058b7631d4f922f2cda723d910a3dcf5f178cd
        x-checker-data:
          type: html
          url: https://dotnetcli.blob.core.windows.net/dotnet/aspnetcore/Runtime/9.0/latest.version
          version-pattern: ^([\d\.a-z-]+)$
          url-template: https://api.nuget.org/v3-flatcontainer/microsoft.aspnetcore.app.runtime.linux-x64/$version/microsoft.aspnetcore.app.runtime.linux-x64.$version.nupkg
      - type: file
        only-arches: [x86_64]
        url: https://api.nuget.org/v3-flatcontainer/microsoft.netcore.app.runtime.linux-x64/9.0.2/microsoft.netcore.app.runtime.linux-x64.9.0.2.nupkg
        sha512: c2255060c468ba30d3cc2a3b9fb2ed910e0b4cf9b284333dfec9b79df28210be6c004405b0d4d574f185e65b43a8f1c82ce8eb90e23a06f19bc6aece31b9e1d9
        x-checker-data:
          type: html
          url: https://dotnetcli.blob.core.windows.net/dotnet/aspnetcore/Runtime/9.0/latest.version
          version-pattern: ^([\d\.a-z-]+)$
          url-template: https://api.nuget.org/v3-flatcontainer/microsoft.netcore.app.runtime.linux-x64/$version/microsoft.netcore.app.runtime.linux-x64.$version.nupkg
      - type: file
        only-arches: [x86_64]
        url: https://api.nuget.org/v3-flatcontainer/microsoft.netcore.app.crossgen2.linux-x64/9.0.2/microsoft.netcore.app.crossgen2.linux-x64.9.0.2.nupkg
        sha512: 95df2156cb56b91449668754c4b7798dd00f30aef5c6ddf434b78c64855c16c41cb10f423fdaadd0fa630f2474cbe652c084249bba67be5ec112aef14c255c41
        x-checker-data:
          type: html
          url: https://dotnetcli.blob.core.windows.net/dotnet/aspnetcore/Runtime/9.0/latest.version
          version-pattern: ^([\d\.a-z-]+)$
          url-template: https://api.nuget.org/v3-flatcontainer/microsoft.netcore.app.crossgen2.linux-x64/$version/microsoft.netcore.app.crossgen2.linux-x64.$version.nupkg
      - type: file
        only-arches: [aarch64]
        url: https://api.nuget.org/v3-flatcontainer/microsoft.aspnetcore.app.runtime.linux-arm64/9.0.2/microsoft.aspnetcore.app.runtime.linux-arm64.9.0.2.nupkg
        sha512: c2bc9d5a0e7a84e157f88317f2226bb17c2fdab6dbe6496b3dd028bfc2aa35c6123142fe44f591331264ea70afb0b557d8849bac4243e7b27fc438c1f644c1ff
        x-checker-data:
          type: html
          url: https://dotnetcli.blob.core.windows.net/dotnet/aspnetcore/Runtime/9.0/latest.version
          version-pattern: ^([\d\.a-z-]+)$
          url-template: https://api.nuget.org/v3-flatcontainer/microsoft.aspnetcore.app.runtime.linux-arm64/$version/microsoft.aspnetcore.app.runtime.linux-arm64.$version.nupkg
      - type: file
        only-arches: [aarch64]
        url: https://api.nuget.org/v3-flatcontainer/microsoft.netcore.app.runtime.linux-arm64/9.0.2/microsoft.netcore.app.runtime.linux-arm64.9.0.2.nupkg
        sha512: 3a1486e1cd03959f94b1594794e2928fb8da27879ced9b1e1ca6c1ab838cd2e22a0cb7a78581fdf5be1ee1917ead74fdb5474c5a5bf82a275063ed2cd77e88b6
        x-checker-data:
          type: html
          url: https://dotnetcli.blob.core.windows.net/dotnet/aspnetcore/Runtime/9.0/latest.version
          version-pattern: ^([\d\.a-z-]+)$
          url-template: https://api.nuget.org/v3-flatcontainer/microsoft.netcore.app.runtime.linux-arm64/$version/microsoft.netcore.app.runtime.linux-arm64.$version.nupkg
      - type: file
        only-arches: [aarch64]
        url: https://api.nuget.org/v3-flatcontainer/microsoft.netcore.app.crossgen2.linux-arm64/9.0.2/microsoft.netcore.app.crossgen2.linux-arm64.9.0.2.nupkg
        sha512: 0a689bd3d87fcab89b7df427ab9714ea36b18b80e97e116bfa52da5abc4f7d5b2d981b31ff5a1082c5a5f94e734918a6e3465d1f5122c49a1145bc048457f5af
        x-checker-data:
          type: html
          url: https://dotnetcli.blob.core.windows.net/dotnet/aspnetcore/Runtime/9.0/latest.version
          version-pattern: ^([\d\.a-z-]+)$
          url-template: https://api.nuget.org/v3-flatcontainer/microsoft.netcore.app.crossgen2.linux-arm64/$version/microsoft.netcore.app.crossgen2.linux-arm64.$version.nupkg
      - type: file
        url: https://api.nuget.org/v3-flatcontainer/microsoft.net.illink.tasks/9.0.2/microsoft.net.illink.tasks.9.0.2.nupkg
        sha512: 52a704fcc619f79e01d3d4d96a85b3881380ae42d02234cb4ece63f348aaa3d1b6e8792e904bf19f87d0dce1bbfa138da081804d1f10022e82e1ce46c511a0ea
        x-checker-data:
          type: html
          url: https://dotnetcli.blob.core.windows.net/dotnet/aspnetcore/Runtime/9.0/latest.version
          version-pattern: ^([\d\.a-z-]+)$
          url-template: https://api.nuget.org/v3-flatcontainer/microsoft.net.illink.tasks/$version/microsoft.net.illink.tasks.$version.nupkg
  - name: scripts
    buildsystem: simple
    build-commands:
      - mkdir -p /usr/lib/sdk/dotnet9/share/appdata
      - cp install.sh install-sdk.sh /usr/lib/sdk/dotnet9/bin
      - cp enable.sh /usr/lib/sdk/dotnet9
      - cp org.freedesktop.Sdk.Extension.dotnet9.appdata.xml ${FLATPAK_DEST}/share/appdata
    sources:
      - type: script
        commands:
          - mkdir -p /app/lib/dotnet
          - mkdir -p /app/bin
          - cp -r /usr/lib/sdk/dotnet9/lib/{dotnet,host,shared} /app/lib/dotnet
          - ln -s /app/lib/dotnet/dotnet /app/bin/dotnet
        dest-filename: install.sh
      - type: script
        commands:
          - /usr/lib/sdk/dotnet9/bin/install.sh
          - cp -r /usr/lib/sdk/dotnet9/lib/sdk /app/lib/dotnet
        dest-filename: install-sdk.sh
      - type: script
        commands:
          - export PATH=$PATH:/usr/lib/sdk/dotnet9/bin
          - export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/lib/sdk/dotnet9/lib
          - export DOTNET_CLI_TELEMETRY_OPTOUT=true
          - export DOTNET_NOLOGO=true
          - export DOTNET_ROOT=/usr/lib/sdk/dotnet9/lib
        dest-filename: enable.sh
      - type: file
        path: org.freedesktop.Sdk.Extension.dotnet9.appdata.xml
