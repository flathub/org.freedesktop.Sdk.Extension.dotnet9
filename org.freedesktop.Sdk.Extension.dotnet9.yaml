app-id: org.freedesktop.Sdk.Extension.dotnet9
branch: '24.08'
runtime: org.freedesktop.Sdk
runtime-version: '24.08'
sdk: org.freedesktop.Sdk
build-extension: true
separate-locales: false
modules:
  - name: dotnet-sdk
    buildsystem: simple
    build-commands:
      - mkdir -p /usr/lib/sdk/dotnet9/{bin,lib}
      - cp -r * /usr/lib/sdk/dotnet9/lib
      - ln -s /usr/lib/sdk/dotnet9/lib/dotnet /usr/lib/sdk/dotnet9/bin/dotnet
    sources:
      - type: archive
        only-arches: [x86_64]
        url: https://dotnetcli.blob.core.windows.net/dotnet/Sdk/9.0.102/dotnet-sdk-9.0.102-linux-x64.tar.gz
        sha256: da999a5f259509829d7dd311785bf4010535c273913a2e56c664b47c8f586e7a
        x-checker-data:
          type: html
          url: https://dotnetcli.blob.core.windows.net/dotnet/Sdk/9.0/latest.version
          version-pattern: ^([\d\.a-z-]+)$
          url-template: https://dotnetcli.blob.core.windows.net/dotnet/Sdk/$version/dotnet-sdk-$version-linux-x64.tar.gz
      - type: archive
        only-arches: [aarch64]
        url: https://dotnetcli.blob.core.windows.net/dotnet/Sdk/9.0.102/dotnet-sdk-9.0.102-linux-arm64.tar.gz
        sha256: 272b846ba23aa47fe78b30ed892c2aeb4b0db8f18c3651accaee467fb11e7a4b
        x-checker-data:
          type: html
          url: https://dotnetcli.blob.core.windows.net/dotnet/Sdk/9.0/latest.version
          version-pattern: ^([\d\.a-z-]+)$
          url-template: https://dotnetcli.blob.core.windows.net/dotnet/Sdk/$version/dotnet-sdk-$version-linux-arm64.tar.gz
  - name: nuget-sources
    buildsystem: simple
    build-commands:
      - mkdir -p /usr/lib/sdk/dotnet9/nuget/packages
      - cp * /usr/lib/sdk/dotnet9/nuget/packages
    sources:
      - type: file
        only-arches: [x86_64]
        url: https://api.nuget.org/v3-flatcontainer/microsoft.aspnetcore.app.runtime.linux-x64/9.0.1/microsoft.aspnetcore.app.runtime.linux-x64.9.0.1.nupkg
        sha512: 34ca27ea19f565c370aafefa63790fb8e1a1711fe5fdd1f525c4f56cdfeaaed348bed10f326692a67517540f7f01acd51b0362b6c45b548f6e67409f5a6f6c8e
        x-checker-data:
          type: html
          url: https://dotnetcli.blob.core.windows.net/dotnet/aspnetcore/Runtime/9.0/latest.version
          version-pattern: ^([\d\.a-z-]+)$
          url-template: https://api.nuget.org/v3-flatcontainer/microsoft.aspnetcore.app.runtime.linux-x64/$version/microsoft.aspnetcore.app.runtime.linux-x64.$version.nupkg
      - type: file
        only-arches: [x86_64]
        url: https://api.nuget.org/v3-flatcontainer/microsoft.netcore.app.runtime.linux-x64/9.0.1/microsoft.netcore.app.runtime.linux-x64.9.0.1.nupkg
        sha512: e25a6bcdd05262fdaebd315c62e55d7469b392a0ec80222eccebac2761c5a30c4726dde674d4bef5f6c5293314198c537b2b10a4d772779a531189ecc27693ba
        x-checker-data:
          type: html
          url: https://dotnetcli.blob.core.windows.net/dotnet/aspnetcore/Runtime/9.0/latest.version
          version-pattern: ^([\d\.a-z-]+)$
          url-template: https://api.nuget.org/v3-flatcontainer/microsoft.netcore.app.runtime.linux-x64/$version/microsoft.netcore.app.runtime.linux-x64.$version.nupkg
      - type: file
        only-arches: [x86_64]
        url: https://api.nuget.org/v3-flatcontainer/microsoft.netcore.app.crossgen2.linux-x64/9.0.0/microsoft.netcore.app.crossgen2.linux-x64.9.0.0.nupkg
        sha512: b67071548bcea3a0e34558b006325cca58e9b0c667338e98d6f06a33c01b30cd5f3b405c28f6c94bcf069a7437ab4acd5a68ba1b6558ed460797ffbda6170608
        x-checker-data:
          type: html
          url: https://dotnetcli.blob.core.windows.net/dotnet/aspnetcore/Runtime/9.0/latest.version
          version-pattern: ^([\d\.a-z-]+)$
          url-template: https://api.nuget.org/v3-flatcontainer/microsoft.netcore.app.crossgen2.linux-x64/$version/microsoft.netcore.app.crossgen2.linux-x64.$version.nupkg
      - type: file
        only-arches: [aarch64]
        url: https://api.nuget.org/v3-flatcontainer/microsoft.aspnetcore.app.runtime.linux-arm64/9.0.1/microsoft.aspnetcore.app.runtime.linux-arm64.9.0.1.nupkg
        sha512: 08bcdf109db42e1176404c7739afe9e06de4484d7b384599e6ce7228fdefa16f2cc3ff8ca0c93963c479ecefa34b29f764c7daba854f07c4c870e96b97fdfe91
        x-checker-data:
          type: html
          url: https://dotnetcli.blob.core.windows.net/dotnet/aspnetcore/Runtime/9.0/latest.version
          version-pattern: ^([\d\.a-z-]+)$
          url-template: https://api.nuget.org/v3-flatcontainer/microsoft.aspnetcore.app.runtime.linux-arm64/$version/microsoft.aspnetcore.app.runtime.linux-arm64.$version.nupkg
      - type: file
        only-arches: [aarch64]
        url: https://api.nuget.org/v3-flatcontainer/microsoft.netcore.app.runtime.linux-arm64/9.0.1/microsoft.netcore.app.runtime.linux-arm64.9.0.1.nupkg
        sha512: 48c029626ff792e41bc4d0f0cb2ec1bd8f5292eb029ba230bb8c0f3d7edf2a743f1b21b035e001248aaad799c0c0949947510a02541ef1a9ab5e9826ae4aeb8a
        x-checker-data:
          type: html
          url: https://dotnetcli.blob.core.windows.net/dotnet/aspnetcore/Runtime/9.0/latest.version
          version-pattern: ^([\d\.a-z-]+)$
          url-template: https://api.nuget.org/v3-flatcontainer/microsoft.netcore.app.runtime.linux-arm64/$version/microsoft.netcore.app.runtime.linux-arm64.$version.nupkg
      - type: file
        only-arches: [aarch64]
        url: https://api.nuget.org/v3-flatcontainer/microsoft.netcore.app.crossgen2.linux-arm64/9.0.1/microsoft.netcore.app.crossgen2.linux-arm64.9.0.1.nupkg
        sha512: a498db3adbb88631d52eefa88687b71d6ef3ec3fd50e5a673bc8024997ad77f0d2b4b8419201f1f4d7b46e275af7e5000c3aa4eb9eddead04d94a9a4e775dede
        x-checker-data:
          type: html
          url: https://dotnetcli.blob.core.windows.net/dotnet/aspnetcore/Runtime/9.0/latest.version
          version-pattern: ^([\d\.a-z-]+)$
          url-template: https://api.nuget.org/v3-flatcontainer/microsoft.netcore.app.crossgen2.linux-arm64/$version/microsoft.netcore.app.crossgen2.linux-arm64.$version.nupkg
      - type: file
        url: https://api.nuget.org/v3-flatcontainer/microsoft.net.illink.tasks/9.0.1/microsoft.net.illink.tasks.9.0.1.nupkg
        sha512: c37852d99d1d429aa4b688722fbea64a4d6a2a73f50931d88349fa2f394ff03568086c835b418a38f60ce8f5b3826b2feb63d5d2ca5426d762259c403e617414
        x-checker-data:
          type: html
          url: https://dotnetcli.blob.core.windows.net/dotnet/aspnetcore/Runtime/9.0/latest.version
          version-pattern: ^([\d\.a-z-]+)$
          url-template: https://api.nuget.org/v3-flatcontainer/microsoft.net.illink.tasks/$version/microsoft.net.illink.tasks.$version.nupkg
  - name: scripts
    buildsystem: simple
    build-commands:
      - mkdir -p /usr/lib/sdk/dotnet9/share/appdata
      - cp install.sh install-sdk.sh /usr/lib/sdk/dotnet9/bin
      - cp enable.sh /usr/lib/sdk/dotnet9
      - cp org.freedesktop.Sdk.Extension.dotnet9.appdata.xml ${FLATPAK_DEST}/share/appdata
    sources:
      - type: script
        commands:
          - mkdir -p /app/lib/dotnet
          - mkdir -p /app/bin
          - cp -r /usr/lib/sdk/dotnet9/lib/{dotnet,host,shared} /app/lib/dotnet
          - ln -s /app/lib/dotnet/dotnet /app/bin/dotnet
        dest-filename: install.sh
      - type: script
        commands:
          - /usr/lib/sdk/dotnet9/bin/install.sh
          - cp -r /usr/lib/sdk/dotnet9/lib/sdk /app/lib/dotnet
        dest-filename: install-sdk.sh
      - type: script
        commands:
          - export PATH=$PATH:/usr/lib/sdk/dotnet9/bin
          - export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/lib/sdk/dotnet9/lib
          - export DOTNET_CLI_TELEMETRY_OPTOUT=true
          - export DOTNET_NOLOGO=true
          - export DOTNET_ROOT=/usr/lib/sdk/dotnet9/lib
        dest-filename: enable.sh
      - type: file
        path: org.freedesktop.Sdk.Extension.dotnet9.appdata.xml
